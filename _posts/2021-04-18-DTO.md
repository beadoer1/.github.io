---
title: "Database 접근 요청 시 DTO(Data Transfer Object) 사용에 대해"
date: 2021-04-20 14:00:00 +0900
categories:
  - Java
tags:
  - DTO
  - DataTransferObject
  - 데이터 전송 객체
  - 객체지향프로그래밍
---

※ 지식 정리는 이곳에👉 [github.com/beadoer1/TIL](https://github.com/beadoer1/TIL)  

## 왜 DTO를 사용해야 하는거지..?
항해99 자바/스프링 강의에 DTO 라는 객체가 등장했다. Entity에 직접 접근하는 객체를 일일이 직접 수정하는 것은 좋지 않기 때문에 '완충제'로써 사용된다는 것이 그 필요성이었는데, '어떤 완충 역할을 해준다는 것인지..', '왜 이를 사용하는 것이 좋은지..'에 대해 명확하게 정리되지 않는 기분이라 글로 남겨보려 한다.

## DTO(Data Transfer Object)란?
DTO는 'Data Transfer Object'의 약자이다. 한글로는 '데이터 운송 객체'. 오.. 풀네임이 좀 직관적이다. 마음에 든다.  
이는 말 그대로 데이터를 전송해주는 역할을 한다. 전송은 출발지와 목적지가 필요하다. 어디서 어디로 보낸다는걸까?  
여태 이를 사용한 프로젝트를 기준으로 해보자면 DTO는 '클라이언트 요청을 서버에서 받는 순간부터 Entity 객체까지' Data를 전달하는 역할을 한다.

## DTO vs Map<>
<p align="center"><img src="/assets/images/DTOvsMap.png"></p>
<div align="center">DTO vs Map.. 별반 달라보이지 않는다.</div>  

그런데 왜 꼭 DTO 여야 할까? Entity 객체와 Mapping할 때 'key':'value' 형태의 Data가 필요하다면 Map을 사용해도 되지 않을까? 실제로 이에 대한 갑론을박이 웹에서 이루어지고 있는 듯 하다. 필자도 Map<>을 사용하는 것이 따로 객체를 만들지 않아도 되고 DTO를 사용하는 것과 큰 차이 없다고 생각했다. 그래서 비슷하면 더 편한 Map<>을 사용하자는 주의였는데, 이에 궁금증을 품은 은인께서 DTO를 사용해야함에 이끌어 주셨다. 그 이유에 대해 이런저런 생각을 해보고 대화도 나누어 본 결과는 아래와 같다.  

### 1. Data의 불변성을 지켜준다.
Data는 웹 서비스의 가장 중요한 자원이다. 이에 이를 운반, 저장, 검색 하는 과정에서 잘못된 데이터로 변경되거나 하는 불확실성의 상황을 만들지 않는 것이 중요하다. DTO는 이를 도와준다. 정확히는 DTO Class를 지정할 때 이런 설정을 해줄 수 있다고 하는 것이 맞겠다. 객체에 의존성 주입을 하는 여러 방식 중 가장 흔히 사용되는 방식은 크게 '생성자 주입 방식'과 '수정자 주입 방식' 두가지가 아닌가 싶다.  
'DTO(Data Transfer Object)'의 경우 프로그래머가 직접 그 class를 정의하기 때문에 주입 방식을 제한할 수가 있다. 객체의 속성을 'private'으로 지정하고 'set method'를 생성하지 않으므로하여, 생성자를 통해 인스턴스를 생성할 때만 의존관계를 주입하고 그 이후에는 내부 데이터를 손대지 못하게 함으로써 Data를 클라이언트에서 입력한 그대로 Entity로 전송할 수 있는 상황을 만들 수 있는 것이다.
이에 반해 'Map<>'의 경우 내부에 있는 데이터를 언제든지 바꿔줄 수 있기 때문에, 데이터가 언제든 바뀔 수 있는 환경 속에서 Entity 까지 전송되어 그 신뢰도가 높지 않게 된다. 만약, 혼자 작업하는 것이 아니라 여럿이 작업하게 될 경우 이는 바꿔도 된다는 시그널이 될 수도 있겠다.  
얼마 전에 좋은 객체 지향 설계의 5가지 원칙(SOLID)에 대해 읽었는데 OCP(Open/Closed Principal)에 대응되는 개념이 아닐까 싶다. 연결지어 기억하고 싶어서 추가로 남겨본다.

### 2. 여러 지정된 타입(자료형)의 value 값을 받을 수 있다.
Map<>의 경우 지네릭스를 이용해 안에 넣을 value 값의 자료형을 지정한다. 이 때 모두 한가지 자료형으로 통일 시키거나, 아니면 상위 클래스의 자료형을 넣거나, 아무거나 들어가게끔 할 수는 있겠으나 모든 value 값에 대해 특정 자료형을 지정하는 것은 불가하다.(적어도 필자가 아는 Java에서는 그러한데.. 혹시나 이 글을 읽으시는 분이 계시고 내용이 틀리다면 지적 부탁 드리겠다.)  
허나 DTO에서는 가능하다. DTO class를 따로 만들기 때문에 안에 입력 받을 속성을 만들 때 그 자료형을 지정할 수 있다. 이는 하나의 입력 필터가 된다. 어중간하게 되게 하느니, 확실히 안되게 하라고 했다. 어중간한 에러는 나중에 문제가 될 때 발견하기도 어렵다. 큰 장점이다.

### 3. 하나의 Data 입력 양식 역할을 해줄 수 있다.
웹 서비스가 관리하는 Data의 범위는 언제든 변할 수 있다. 회사 혹은 운영자의 운영방침에 따라 객체를 기준으로 그 속성의 종류가 늘고 줄어드는 것이 보다 편하고 자유로운 프로그램이 좋은 프로그램이라고 할 수 있겠다. 이 때, '편하고 자유롭다'라는 말은 입력 혹은 수정 등을 요청하는 클라이언트 측 혹은 같이 일하고 있는 서버 측 엔지니어와의 소통에도 적용이 될 것이다. 물론, DTO와 최종으로 DB에 들어가는 Entity 객체의 속성에 차이가 없다면 DTO나 Map<>이나 그 영향에는 크게 다름이 없을 것이라고 생각한다. 하지만 중간에 값의 형태가 변해야하여 가공된 값을 이용해 Entity 객체를 만들어야 한다면? 그리고 그 변화가 자주 일어나는 상황에 놓여져 있다면?? 소통을 기계처럼 해낸다면 문제 없겠지만, 소통은 언제나 완전하지 못하다. 하여, 우리에겐 공통적으로 확인 가능한 문서나 기준이 필요한데, DTO가 하나의 기준 역할을 해줄 수 있다. 서버 엔지니어 끼리는 변동된 코드에 대해 이 때 필요한 속성값들을 DTO에 넣어주므로써 어떤 요소가 변동됐는지 알 수 있고, 이를 이용해 클라이언트 측에 어떤 값을 받아야하는지도 전달할 수 있는 것이다. 이런 면에서는 하나의 완충제 역할이라고 설명한 부분도 이해가 된다.

### ※ 아직 남아있는 의문
그럼에도 아직 남아있는 의문들이 있다. 여태까지는 Entity 인스턴스 생성자에 DTO를 직접 넣어주는 식으로 인스턴스를 만들고는 하였다. 헌데 중간에 값을 더하거나 빼려면 set 연산자가 필요한 경우들이 있었고, 이 때는 DTO의 강점을 잃게 만드는 것 같아 찝찝함이 가시질 않았다.  
또한, 입력되는 값과 실제 Entity에 반영할 값의 속성(key)이 다른 경우에도 DTO를 통해 옮기는 것이 옳은 방법인가에 대한 의문이 남는다. 입력 받은 값의 불변성을 유지하려면 당연히 그게 옳겠으나 여태 Entity 속성과 맞추어 DTO를 만들다보니 아예 다른 속성을 가진 DTO를 만드는 것이 어색하여 그런 것인가 싶다. 이는 항해99라는 프로그램에 참여 중이니만큼 튜터님들이랑 이야기 해봐도 좋지 않을까 하는 생각이 든다. 

### ☻ 잠깐 다른 생각
인지하지 못하고 있었는데 질문에 대한 거부감이 있었던 듯 하다. 보다 앞에 있는 사람들의 캐리를 적극적으로 받자.
 
